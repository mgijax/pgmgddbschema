#!/bin/sh

cd `dirname $0` && . ./Configuration

cat - <<EOSQL | ${PG_DBUTILS}/bin/doisql.csh $0

ALTER TABLE mgd.DAG_Node ADD PRIMARY KEY (_Node_key);

ALTER TABLE mgd.DAG_Closure ADD FOREIGN KEY (_Ancestor_key) REFERENCES mgd.DAG_Node ON DELETE CASCADE DEFERRABLE;

ALTER TABLE mgd.DAG_Closure ADD FOREIGN KEY (_Descendent_key) REFERENCES mgd.DAG_Node ON DELETE CASCADE DEFERRABLE;

ALTER TABLE mgd.DAG_Edge ADD FOREIGN KEY (_Parent_key) REFERENCES mgd.DAG_Node ON DELETE CASCADE DEFERRABLE;

ALTER TABLE mgd.DAG_Edge ADD FOREIGN KEY (_Child_key) REFERENCES mgd.DAG_Node ON DELETE CASCADE DEFERRABLE;

EOSQL
