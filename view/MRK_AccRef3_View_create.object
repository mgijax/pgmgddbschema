#!/bin/sh

#
# History
#
# 06/24/2015	lec
#	- TR12038/see TR for details
#
# 09/07/2010	lec
#	TR 10337
#	add view for these specific logical dbs:
#
#	122     Affy1.0
#	123     Affy430        
#	144     AffyU74        
#	107     AllenBrainAtlas        
#	130     ArrayExpress        
#	136     CCDS        
#	8       EC
#	124     FuncBase        
#	81      HomoloGene
#	83	miRBase
#	45	PDB
#	135     ProteinOntology        
#	25      RIKENCluster
#	23      UniGene
#

cd `dirname $0` && . ./Configuration

${PG_MGD_DBSCHEMADIR}/view/MRK_AccRef3_View_drop.object

cat - <<EOSQL | ${PG_DBUTILS}/bin/doisql.csh $0

create view mgd.MRK_AccRef3_View
as
select a.*, l.name as LogicalDB, 
m.name as MGIType, 
ar._Refs_key, 
b.numericPart as jnum,
b.short_citation,
b.jnumID,
u1.login as modifiedBy
from ACC_Accession a, ACC_LogicalDB l, ACC_MGIType m, ACC_AccessionReference ar, BIB_Citation_Cache b, MGI_User u1
where a._MGIType_key = 2
and a._Accession_key = ar._Accession_key
and a._LogicalDB_key = l._LogicalDB_key
and a._MGIType_key = m._MGIType_key
and ar._Refs_key = b._Refs_key
and a._ModifiedBy_key = u1._User_key
and a._LogicalDB_key in (122,123,144,107,130,136,8,124,81,83,45,135,25,86,88,23)



;

EOSQL
