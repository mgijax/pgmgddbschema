#!/bin/sh

#
# History
#
# lec 03/18/2003
#	- SAO
#

cd `dirname $0` && . ./Configuration

cat - <<EOSQL | ${PG_DBUTILS}/bin/doisql.csh $0

DROP FUNCTION ACCRef_insert(int,int);

CREATE OR REPLACE FUNCTION ACCRef_insert (
v_accKey int,
v_refsKey int
)
RETURNS VOID AS
\$\$

DECLARE
v_userKey int;

BEGIN

/* Insert record into ACC_AccessionReference table */
SELECT INTO v_userKey _User_key FROM MGI_User WHERE login = current_user;

INSERT INTO ACC_AccessionReference
(_Accession_key, _Refs_key, _CreatedBy_key, _ModifiedBy_key)
VALUES(v_accKey, v_refsKey, v_userKey, v_userKey)
;

END;
\$\$
LANGUAGE plpgsql;

GRANT EXECUTE ON FUNCTION ACCRef_insert(int,int) TO public;

COMMENT ON FUNCTION mgd.ACCRef_insert(int, int) IS 'creates a new acc_accessionreference row';

EOSQL
